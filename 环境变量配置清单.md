# ðŸ”§ çŽ¯å¢ƒå˜é‡é…ç½®æ¸…å•

## ðŸ“‹ å‰ç«¯çŽ¯å¢ƒå˜é‡ï¼ˆ`.env.local` æˆ– Vercelï¼‰

### å¿…éœ€é…ç½®

```env
# NextAuth é…ç½®ï¼ˆå¿…éœ€ï¼‰
NEXTAUTH_SECRET=ä½ çš„å¯†é’¥ï¼ˆä¸ŽåŽç«¯ JWT_SECRET ç›¸åŒï¼‰
NEXTAUTH_URL=http://localhost:3000  # å¼€å‘çŽ¯å¢ƒ
# ç”Ÿäº§çŽ¯å¢ƒï¼šNEXTAUTH_URL=https://your-domain.com

# ç®¡ç†å‘˜è´¦å·ï¼ˆç”¨äºŽå‰ç«¯ç™»å½•ï¼‰
# æ ¼å¼ï¼šusername:password,username2:password2
# æ³¨æ„ï¼šå¯†ç éœ€è¦ä¸ŽåŽç«¯ USER_WHITELIST åŒ¹é…
ADMIN_USERS=test:test123,admin:admin123
# æˆ–è€…ä½¿ç”¨ email æ ¼å¼ï¼š
# ADMIN_USERS=test@factory-buy.com:test123,admin@factory-buy.com:admin123
```

### åŽç«¯ API é…ç½®

```env
# åŽç«¯ API åœ°å€
NEXT_PUBLIC_BACKEND_API_URL=https://api.factory-buy.com

# åŽç«¯ç™»å½•é…ç½®ï¼ˆç”¨äºŽèŽ·å–åŽç«¯ tokenï¼‰
# æ³¨æ„ï¼šè¿™äº›é…ç½®éœ€è¦ä¸ŽåŽç«¯ USER_WHITELIST åŒ¹é…
BACKEND_TEST_EMAIL=test@factory-buy.com  # åŽç«¯ USER_WHITELIST ä¸­çš„ email
BACKEND_TEST_PASSWORD=password123         # åŽç«¯ USER_WHITELIST ä¸­çš„å¯†ç 
```

### å¯é€‰é…ç½®ï¼ˆAI åŠŸèƒ½ï¼‰

```env
# AI å›¾åƒåˆ†æžé…ç½®ï¼ˆFallback æ–¹æ¡ˆï¼‰
AI_IMAGE_API_KEY=sk-xxxxx
AI_IMAGE_API_ENDPOINT=https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions
AI_IMAGE_API_MODEL=qwen-vl-plus-latest

# å³æ¢¦è§†é¢‘ç”Ÿæˆé…ç½®
JIMENG_ACCESS_KEY=AKLTxxxxx
JIMENG_SECRET_KEY=xxxxx
JIMENG_API_ENDPOINT=https://visual.volcengineapi.com
JIMENG_REGION=cn-north-1
```

---

## ðŸ“‹ åŽç«¯çŽ¯å¢ƒå˜é‡ï¼ˆæœåŠ¡å™¨ `.env`ï¼‰

### å¿…éœ€é…ç½®

```env
# JWT å¯†é’¥ï¼ˆå¿…é¡»ä¸Žå‰ç«¯ NEXTAUTH_SECRET ç›¸åŒï¼‰
JWT_SECRET=ä½ çš„å¯†é’¥ï¼ˆä¸Žå‰ç«¯ç›¸åŒï¼‰
NEXTAUTH_SECRET=ä½ çš„å¯†é’¥ï¼ˆä¸Žå‰ç«¯ç›¸åŒï¼‰

# ç”¨æˆ·ç™½åå•ï¼ˆæ ¼å¼ï¼šemail:password,email2:password2ï¼‰
# æ³¨æ„ï¼šå¯†ç éœ€è¦ä¸Žå‰ç«¯ ADMIN_USERS æˆ– BACKEND_TEST_PASSWORD åŒ¹é…
USER_WHITELIST=test@factory-buy.com:test123,admin@factory-buy.com:admin123

# åˆå§‹ç§¯åˆ†
INITIAL_CREDITS=100
```

### Dry Run æ¨¡å¼é…ç½®ï¼ˆæŽ¨èç”¨äºŽæµ‹è¯•ï¼‰

```env
# Dry Run æ¨¡å¼ï¼ˆ0æˆæœ¬æµ‹è¯•ï¼‰
MODEL_ENABLED=false          # ç¦ç”¨çœŸå®žæ¨¡åž‹è°ƒç”¨ï¼Œè¿”å›ž mock æ•°æ®
BILLING_ENABLED=false        # ç¦ç”¨çœŸå®žæ‰£è´¹ï¼Œè¿”å›žæ¨¡æ‹Ÿç»“æžœ
```

### çœŸå®žæ¨¡å¼é…ç½®ï¼ˆç”Ÿäº§çŽ¯å¢ƒï¼‰

```env
# çœŸå®žæ¨¡å¼ï¼ˆç”Ÿäº§çŽ¯å¢ƒï¼‰
MODEL_ENABLED=true           # å¯ç”¨çœŸå®žæ¨¡åž‹è°ƒç”¨
BILLING_ENABLED=true         # å¯ç”¨çœŸå®žæ‰£è´¹

# çœŸå®žæ¨¡å¼ç”¨æˆ·ç™½åå•ï¼ˆå¯é€‰ï¼‰
# å¦‚æžœé…ç½®ï¼Œè¿™äº›ç”¨æˆ·å°†ä½¿ç”¨ REAL æ¨¡å¼ï¼Œå…¶ä»–ç”¨æˆ·ä½¿ç”¨ DRY_RUN
REAL_MODE_USERS=admin@factory-buy.com
```

### æ•°æ®åº“é…ç½®

```env
# PostgreSQL æ•°æ®åº“
DATABASE_URL=postgresql://user:password@localhost:5432/ue_assets_db
```

### ç§¯åˆ†ç³»ç»Ÿé…ç½®

```env
# å•æ¬¡æ¶ˆè´¹ä¸Šé™
MAX_SINGLE_CONSUME=100

# æ¯æ—¥æ¶ˆè´¹ä¸Šé™
DAILY_COST_LIMIT=1000
```

### AI æ¨¡åž‹é…ç½®ï¼ˆå¯é€‰ï¼ŒDry Run æ¨¡å¼ä¸‹ä¸ä½¿ç”¨ï¼‰

```env
# æ¨¡åž‹æä¾›å•†
MODEL_PROVIDER=qwen

# Qwen é…ç½®
QWEN_API_KEY=sk-xxxxx
QWEN_MODEL=qwen-turbo
QWEN_BASE_URL=https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation
```

### æœåŠ¡å™¨é…ç½®

```env
PORT=3001
NODE_ENV=production
FRONTEND_URL=https://your-domain.com
```

---

## ðŸ”‘ å¯†é’¥ç”Ÿæˆæ–¹æ³•

### ç”Ÿæˆ NEXTAUTH_SECRET / JWT_SECRET

```bash
# æ–¹æ³• 1ï¼šä½¿ç”¨ OpenSSL
openssl rand -base64 32

# æ–¹æ³• 2ï¼šä½¿ç”¨ Node.js
node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
```

**é‡è¦ï¼š**
- å‰ç«¯å’ŒåŽç«¯çš„ `NEXTAUTH_SECRET` å’Œ `JWT_SECRET` å¿…é¡»**å®Œå…¨ç›¸åŒ**
- ä½¿ç”¨å¼ºéšæœºå¯†é’¥ï¼Œè‡³å°‘ 32 å­—ç¬¦
- ä¸è¦å°†å¯†é’¥æäº¤åˆ° Git

---

## âœ… é…ç½®æ£€æŸ¥æ¸…å•

### å‰ç«¯é…ç½®æ£€æŸ¥

- [ ] `NEXTAUTH_SECRET` å·²é…ç½®
- [ ] `NEXTAUTH_URL` å·²é…ç½®ï¼ˆå¼€å‘/ç”Ÿäº§çŽ¯å¢ƒï¼‰
- [ ] `ADMIN_USERS` å·²é…ç½®ï¼ˆè‡³å°‘ä¸€ä¸ªç”¨æˆ·ï¼‰
- [ ] `BACKEND_TEST_PASSWORD` å·²é…ç½®ï¼ˆæˆ– ADMIN_USERS ä¸­é…ç½®äº†å¯†ç ï¼‰
- [ ] `NEXT_PUBLIC_BACKEND_API_URL` å·²é…ç½®

### åŽç«¯é…ç½®æ£€æŸ¥

- [ ] `JWT_SECRET` å·²é…ç½®ï¼ˆä¸Žå‰ç«¯ NEXTAUTH_SECRET ç›¸åŒï¼‰
- [ ] `NEXTAUTH_SECRET` å·²é…ç½®ï¼ˆä¸Žå‰ç«¯ç›¸åŒï¼‰
- [ ] `USER_WHITELIST` å·²é…ç½®ï¼ˆè‡³å°‘ä¸€ä¸ªç”¨æˆ·ï¼Œå¯†ç ä¸Žå‰ç«¯åŒ¹é…ï¼‰
- [ ] `MODEL_ENABLED=false` å·²é…ç½®ï¼ˆDry Run æ¨¡å¼ï¼‰
- [ ] `BILLING_ENABLED=false` å·²é…ç½®ï¼ˆDry Run æ¨¡å¼ï¼‰
- [ ] `INITIAL_CREDITS` å·²é…ç½®

### å¯†ç åŒ¹é…æ£€æŸ¥

**å‰ç«¯ `ADMIN_USERS` å’ŒåŽç«¯ `USER_WHITELIST` å¿…é¡»åŒ¹é…ï¼š**

**ç¤ºä¾‹ï¼š**
```env
# å‰ç«¯
ADMIN_USERS=test:test123

# åŽç«¯
USER_WHITELIST=test@admin.local:test123
# æˆ–è€…
USER_WHITELIST=test:test123
```

**æ³¨æ„ï¼š**
- å¦‚æžœå‰ç«¯ä½¿ç”¨ `username:password`ï¼ŒåŽç«¯å¯ä»¥ä½¿ç”¨ `username@admin.local:password` æˆ– `username:password`
- å¦‚æžœå‰ç«¯ä½¿ç”¨ `email:password`ï¼ŒåŽç«¯å¿…é¡»ä½¿ç”¨ç›¸åŒçš„ `email:password`

---

## ðŸš€ å¿«é€Ÿé…ç½®è„šæœ¬

### å‰ç«¯é…ç½®

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º .env.local
cat > .env.local << 'EOF'
NEXTAUTH_SECRET=$(openssl rand -base64 32)
NEXTAUTH_URL=http://localhost:3000
ADMIN_USERS=test:test123
BACKEND_TEST_PASSWORD=test123
NEXT_PUBLIC_BACKEND_API_URL=https://api.factory-buy.com
EOF
```

### åŽç«¯é…ç½®

```bash
# åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»º .env
cat > /opt/ue-assets-backend/backend-api/.env << 'EOF'
JWT_SECRET=ä½ çš„å¯†é’¥ï¼ˆä¸Žå‰ç«¯ç›¸åŒï¼‰
NEXTAUTH_SECRET=ä½ çš„å¯†é’¥ï¼ˆä¸Žå‰ç«¯ç›¸åŒï¼‰
USER_WHITELIST=test@admin.local:test123
MODEL_ENABLED=false
BILLING_ENABLED=false
INITIAL_CREDITS=100
EOF
```

---

## ðŸ“ é…ç½®ç¤ºä¾‹

### æœ€å°é…ç½®ï¼ˆDry Run æ¨¡å¼ï¼‰

**å‰ç«¯ `.env.local`ï¼š**
```env
NEXTAUTH_SECRET=your-secret-key-here
NEXTAUTH_URL=http://localhost:3000
ADMIN_USERS=test:test123
BACKEND_TEST_PASSWORD=test123
NEXT_PUBLIC_BACKEND_API_URL=https://api.factory-buy.com
```

**åŽç«¯ `.env`ï¼š**
```env
JWT_SECRET=your-secret-key-here
NEXTAUTH_SECRET=your-secret-key-here
USER_WHITELIST=test@admin.local:test123
MODEL_ENABLED=false
BILLING_ENABLED=false
INITIAL_CREDITS=100
```

### ç”Ÿäº§çŽ¯å¢ƒé…ç½®

**å‰ç«¯ï¼ˆVercelï¼‰ï¼š**
```env
NEXTAUTH_SECRET=your-production-secret-key
NEXTAUTH_URL=https://your-domain.com
ADMIN_USERS=admin@factory-buy.com:secure-password
BACKEND_TEST_PASSWORD=secure-password
NEXT_PUBLIC_BACKEND_API_URL=https://api.factory-buy.com
```

**åŽç«¯ï¼ˆæœåŠ¡å™¨ï¼‰ï¼š**
```env
JWT_SECRET=your-production-secret-key
NEXTAUTH_SECRET=your-production-secret-key
USER_WHITELIST=admin@factory-buy.com:secure-password
MODEL_ENABLED=true
BILLING_ENABLED=true
REAL_MODE_USERS=admin@factory-buy.com
INITIAL_CREDITS=1000
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å¯†ç åŒæ­¥**ï¼šå‰ç«¯å’ŒåŽç«¯çš„å¯†ç å¿…é¡»åŒ¹é…
2. **JWT Secret åŒæ­¥**ï¼šå‰ç«¯å’ŒåŽç«¯çš„å¯†é’¥å¿…é¡»ç›¸åŒ
3. **é»˜è®¤å®‰å…¨**ï¼šé»˜è®¤ä½¿ç”¨ DRY_RUN æ¨¡å¼
4. **ç”Ÿäº§çŽ¯å¢ƒ**ï¼šç¡®ä¿ä½¿ç”¨å¼ºå¯†ç å’Œå¼ºå¯†é’¥

