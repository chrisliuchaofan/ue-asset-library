# ğŸš€ éƒ¨ç½²æŒ‡å— - å°ç™½ç‰ˆï¼ˆä¸€æ­¥ä¸€æ­¥æ¥ï¼‰

> æœ¬æŒ‡å—ä¸“ä¸ºæ–°æ‰‹è®¾è®¡ï¼Œæ¯ä¸€æ­¥éƒ½æœ‰è¯¦ç»†è¯´æ˜å’Œæˆªå›¾æç¤º

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡æ¸…å•

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®è®¤ä½ å·²ç»å‡†å¤‡å¥½ï¼š

- [ ] âœ… **åŸŸå**ï¼ˆä½ å·²ç»å‡†å¤‡å¥½äº†ï¼‰
- [ ] â¬œ **Vercel è´¦å·**ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œéœ€è¦æ³¨å†Œï¼šhttps://vercel.comï¼‰
- [ ] â¬œ **GitHub/GitLab è´¦å·**ï¼ˆç”¨äºå­˜æ”¾ä»£ç ï¼‰
- [ ] â¬œ **é˜¿é‡Œäº‘ OSS é…ç½®**ï¼ˆå¦‚æœä½¿ç”¨äº‘å­˜å‚¨ï¼‰
- [ ] â¬œ **åç«¯æœåŠ¡å™¨**ï¼ˆå¦‚æœæœ‰åç«¯ APIï¼‰

---

## ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡ä»£ç ä»“åº“

### 1.1 å°†ä»£ç æ¨é€åˆ° GitHub

å¦‚æœä½ è¿˜æ²¡æœ‰æŠŠä»£ç æ¨é€åˆ° GitHubï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

1. **åœ¨ GitHub åˆ›å»ºæ–°ä»“åº“**
   - è®¿é—® https://github.com/new
   - ä»“åº“åç§°ï¼š`ue-asset-library`ï¼ˆæˆ–ä½ å–œæ¬¢çš„åå­—ï¼‰
   - é€‰æ‹© **Public** æˆ– **Private**
   - ç‚¹å‡» **Create repository**

2. **åœ¨æœ¬åœ°æ¨é€ä»£ç **

æ‰“å¼€ç»ˆç«¯ï¼ˆTerminalï¼‰ï¼Œè¿›å…¥é¡¹ç›®ç›®å½•ï¼š

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /Users/chrisl/Documents/æ’æ˜ŸUEèµ„äº§åº“/web

# åˆå§‹åŒ– Gitï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
git init

# æ·»åŠ æ‰€æœ‰æ–‡ä»¶
git add .

# æäº¤ä»£ç 
git commit -m "Initial commit"

# æ·»åŠ è¿œç¨‹ä»“åº“ï¼ˆæ›¿æ¢ YOUR_USERNAME å’Œ YOUR_REPO_NAMEï¼‰
git remote add origin https://github.com/YOUR_USERNAME/YOUR_REPO_NAME.git

# æ¨é€ä»£ç 
git branch -M main
git push -u origin main
```

> ğŸ’¡ **æç¤º**ï¼šå¦‚æœé‡åˆ°æƒé™é—®é¢˜ï¼Œå¯èƒ½éœ€è¦é…ç½® SSH å¯†é’¥æˆ–ä½¿ç”¨ GitHub Desktop

---

## ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²åˆ° Vercelï¼ˆå‰ç«¯ï¼‰

### 2.1 ç™»å½• Vercel

1. è®¿é—® https://vercel.com
2. ç‚¹å‡» **Sign Up** æ³¨å†Œè´¦å·ï¼ˆå¯ä»¥ç”¨ GitHub è´¦å·ç™»å½•ï¼‰
3. ç™»å½•åè¿›å…¥ Dashboard

### 2.2 å¯¼å…¥é¡¹ç›®

1. åœ¨ Vercel Dashboard ç‚¹å‡» **Add New** â†’ **Project**
2. é€‰æ‹© **Import Git Repository**
3. æ‰¾åˆ°ä½ çš„ä»“åº“ï¼Œç‚¹å‡» **Import**

### 2.3 é…ç½®é¡¹ç›®

Vercel ä¼šè‡ªåŠ¨æ£€æµ‹åˆ°è¿™æ˜¯ Next.js é¡¹ç›®ï¼Œé€šå¸¸ä¸éœ€è¦ä¿®æ”¹ï¼Œä½†è¯·ç¡®è®¤ï¼š

- **Framework Preset**: `Next.js` âœ…
- **Root Directory**: `./` ï¼ˆå¦‚æœé¡¹ç›®åœ¨æ ¹ç›®å½•ï¼‰
- **Build Command**: `npm run build` âœ…
- **Output Directory**: `.next` âœ…

> âš ï¸ **æ³¨æ„**ï¼šå¦‚æœä½ çš„é¡¹ç›®åœ¨ `web` å­ç›®å½•ï¼Œéœ€è¦ï¼š
> - ç‚¹å‡» **Root Directory** æ—è¾¹çš„ **Edit**
> - è¾“å…¥ `web`
> - ç‚¹å‡» **Save**

### 2.4 é…ç½®ç¯å¢ƒå˜é‡ï¼ˆé‡è¦ï¼ï¼‰

åœ¨éƒ¨ç½²ä¹‹å‰ï¼Œéœ€è¦é…ç½®ç¯å¢ƒå˜é‡ã€‚ç‚¹å‡» **Environment Variables** æ·»åŠ ä»¥ä¸‹å˜é‡ï¼š

#### ğŸ” å¿…é¡»é…ç½®çš„å˜é‡ï¼š

```env
# NextAuth è®¤è¯ï¼ˆå¿…é¡»ï¼‰
NEXTAUTH_SECRET=ä½ çš„å¯†é’¥ï¼ˆä¸‹é¢ä¼šæ•™ä½ æ€ä¹ˆç”Ÿæˆï¼‰
NEXTAUTH_URL=https://ä½ çš„åŸŸå.vercel.app

# åç«¯ APIï¼ˆå¦‚æœæœ‰åç«¯ï¼‰
BACKEND_API_URL=https://api.ä½ çš„åŸŸå.com

# ç”¨æˆ·ç™½åå•ï¼ˆæµ‹è¯•è´¦å·ï¼‰
USER_WHITELIST=test@example.com:password123
```

#### ğŸ“¦ OSS é…ç½®ï¼ˆå¦‚æœä½¿ç”¨é˜¿é‡Œäº‘ OSSï¼‰ï¼š

```env
OSS_BUCKET=ä½ çš„bucketåç§°
OSS_REGION=oss-cn-hangzhou
OSS_ACCESS_KEY_ID=ä½ çš„AccessKey
OSS_ACCESS_KEY_SECRET=ä½ çš„SecretKey
NEXT_PUBLIC_CDN_BASE=https://ä½ çš„CDNåŸŸå.com
```

#### ğŸ¤– AI é…ç½®ï¼ˆå¦‚æœä½¿ç”¨ AI åŠŸèƒ½ï¼‰ï¼š

```env
AI_IMAGE_API_KEY=ä½ çš„AIå¯†é’¥
AI_IMAGE_API_ENDPOINT=https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation
```

#### ğŸ¬ å³æ¢¦è§†é¢‘é…ç½®ï¼ˆå¦‚æœä½¿ç”¨ï¼‰ï¼š

```env
JIMENG_REQ_KEY=jimeng_i2v_first_v30
```

### 2.5 ç”Ÿæˆå¯†é’¥

åœ¨é…ç½® `NEXTAUTH_SECRET` ä¹‹å‰ï¼Œéœ€è¦ç”Ÿæˆä¸€ä¸ªéšæœºå¯†é’¥ï¼š

**æ–¹æ³• 1ï¼šä½¿ç”¨åœ¨çº¿å·¥å…·**
- è®¿é—® https://generate-secret.vercel.app/32
- å¤åˆ¶ç”Ÿæˆçš„å¯†é’¥

**æ–¹æ³• 2ï¼šä½¿ç”¨å‘½ä»¤è¡Œ**
```bash
# Mac/Linux
openssl rand -base64 32

# Windows (PowerShell)
[Convert]::ToBase64String((1..32 | ForEach-Object { Get-Random -Maximum 256 }))
```

### 2.6 å¼€å§‹éƒ¨ç½²

1. ç¡®è®¤æ‰€æœ‰ç¯å¢ƒå˜é‡éƒ½å·²æ·»åŠ 
2. ç‚¹å‡» **Deploy** æŒ‰é’®
3. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆé€šå¸¸ 2-5 åˆ†é’Ÿï¼‰

> ğŸ’¡ **æç¤º**ï¼šéƒ¨ç½²è¿‡ç¨‹ä¸­å¯ä»¥åœ¨ **Deployments** æ ‡ç­¾é¡µæŸ¥çœ‹æ—¥å¿—

---

## ç¬¬ä¸‰æ­¥ï¼šé…ç½®åŸŸå

### 3.1 åœ¨ Vercel æ·»åŠ åŸŸå

1. è¿›å…¥é¡¹ç›® â†’ **Settings** â†’ **Domains**
2. åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ä½ çš„åŸŸåï¼ˆä¾‹å¦‚ï¼š`example.com`ï¼‰
3. ç‚¹å‡» **Add**
4. Vercel ä¼šæ˜¾ç¤ºéœ€è¦é…ç½®çš„ DNS è®°å½•

### 3.2 é…ç½® DNS è®°å½•

æ ¹æ® Vercel çš„æç¤ºï¼Œåœ¨ä½ çš„åŸŸåæœåŠ¡å•†ï¼ˆå¦‚é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ï¼‰æ·»åŠ  DNS è®°å½•ï¼š

**é€šå¸¸éœ€è¦æ·»åŠ ï¼š**

| ç±»å‹ | åç§° | å€¼ | TTL |
|------|------|-----|-----|
| A | @ | 76.76.21.21 | è‡ªåŠ¨ |
| CNAME | www | cname.vercel-dns.com | è‡ªåŠ¨ |

> ğŸ’¡ **æç¤º**ï¼šVercel ä¼šæ˜¾ç¤ºå…·ä½“çš„ DNS é…ç½®ï¼ŒæŒ‰ç…§æç¤ºæ“ä½œå³å¯

### 3.3 ç­‰å¾… DNS ç”Ÿæ•ˆ

DNS ç”Ÿæ•ˆé€šå¸¸éœ€è¦å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ï¼Œä½ å¯ä»¥ï¼š

1. åœ¨ Vercel çš„ Domains é¡µé¢æŸ¥çœ‹çŠ¶æ€
2. å½“æ˜¾ç¤º **Valid Configuration** æ—¶ï¼ŒåŸŸåé…ç½®æˆåŠŸ

---

## ç¬¬å››æ­¥ï¼šæµ‹è¯•éƒ¨ç½²

### 4.1 è®¿é—®ç½‘ç«™

1. æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ä½ çš„åŸŸå
2. å¦‚æœçœ‹åˆ°ç½‘ç«™æ­£å¸¸æ˜¾ç¤ºï¼Œè¯´æ˜éƒ¨ç½²æˆåŠŸï¼ğŸ‰

### 4.2 æµ‹è¯•åŠŸèƒ½

- [ ] é¦–é¡µèƒ½æ­£å¸¸æ‰“å¼€
- [ ] å¯ä»¥æœç´¢èµ„äº§
- [ ] å¯ä»¥æŸ¥çœ‹èµ„äº§è¯¦æƒ…
- [ ] ç™»å½•åŠŸèƒ½æ­£å¸¸ï¼ˆå¦‚æœé…ç½®äº†ï¼‰

### 4.3 æ£€æŸ¥æ§åˆ¶å°

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. æŸ¥çœ‹ **Console** æ ‡ç­¾é¡µæ˜¯å¦æœ‰é”™è¯¯
3. æŸ¥çœ‹ **Network** æ ‡ç­¾é¡µï¼Œæ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ

---

## ç¬¬äº”æ­¥ï¼šéƒ¨ç½²åç«¯ï¼ˆå¦‚æœæœ‰ï¼‰

å¦‚æœä½ çš„é¡¹ç›®æœ‰åç«¯ APIï¼Œéœ€è¦éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼š

### 5.1 å‡†å¤‡æœåŠ¡å™¨

ä½ éœ€è¦ä¸€å°äº‘æœåŠ¡å™¨ï¼ˆå¦‚é˜¿é‡Œäº‘ ECSã€è…¾è®¯äº‘ CVMï¼‰ï¼š

1. è´­ä¹°æœåŠ¡å™¨ï¼ˆå»ºè®® 2æ ¸4G èµ·æ­¥ï¼‰
2. é€‰æ‹© Ubuntu æˆ– CentOS ç³»ç»Ÿ
3. è®°å½•æœåŠ¡å™¨çš„å…¬ç½‘ IP

### 5.2 è¿æ¥æœåŠ¡å™¨

ä½¿ç”¨ SSH è¿æ¥æœåŠ¡å™¨ï¼š

```bash
ssh root@ä½ çš„æœåŠ¡å™¨IP
```

> ğŸ’¡ **æç¤º**ï¼šWindows ç”¨æˆ·å¯ä»¥ä½¿ç”¨ PuTTY æˆ– Windows Terminal

### 5.3 å®‰è£… Node.js

```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£… Node.js 20
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs

# éªŒè¯å®‰è£…
node --version
npm --version
```

### 5.4 ä¸Šä¼ åç«¯ä»£ç 

**æ–¹æ³• 1ï¼šä½¿ç”¨ Git**

```bash
# åœ¨æœåŠ¡å™¨ä¸Š
cd /opt
git clone https://github.com/YOUR_USERNAME/YOUR_REPO_NAME.git
cd YOUR_REPO_NAME/backend-api
npm install
npm run build
```

**æ–¹æ³• 2ï¼šä½¿ç”¨ SCPï¼ˆä»æœ¬åœ°ï¼‰**

```bash
# åœ¨æœ¬åœ°ç»ˆç«¯æ‰§è¡Œ
scp -r backend-api/* root@ä½ çš„æœåŠ¡å™¨IP:/opt/ue-assets-backend/
```

### 5.5 é…ç½®ç¯å¢ƒå˜é‡

åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
cd /opt/ue-assets-backend
nano .env
```

æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```env
PORT=3001
NODE_ENV=production
FRONTEND_URL=https://ä½ çš„åŸŸå.com
JWT_SECRET=ä½ çš„å¯†é’¥ï¼ˆä¸Vercelçš„NEXTAUTH_SECRETç›¸åŒï¼‰
USER_WHITELIST=test@example.com:password123
INITIAL_CREDITS=100
```

ä¿å­˜ï¼šæŒ‰ `Ctrl + X`ï¼Œç„¶åæŒ‰ `Y`ï¼Œæœ€åæŒ‰ `Enter`

### 5.6 å¯åŠ¨æœåŠ¡

```bash
# å®‰è£… PM2ï¼ˆè¿›ç¨‹ç®¡ç†å™¨ï¼‰
sudo npm install -g pm2

# å¯åŠ¨æœåŠ¡
pm2 start dist/main.js --name ue-assets-backend

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save

# æŸ¥çœ‹çŠ¶æ€
pm2 status
```

### 5.7 é…ç½® Nginxï¼ˆå¯é€‰ï¼Œæ¨èï¼‰

```bash
# å®‰è£… Nginx
sudo apt install nginx

# åˆ›å»ºé…ç½®æ–‡ä»¶
sudo nano /etc/nginx/sites-available/ue-assets-backend
```

æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```nginx
server {
    listen 80;
    server_name api.ä½ çš„åŸŸå.com;

    location / {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

å¯ç”¨é…ç½®ï¼š

```bash
sudo ln -s /etc/nginx/sites-available/ue-assets-backend /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### 5.8 é…ç½® SSLï¼ˆHTTPSï¼‰

```bash
# å®‰è£… Certbot
sudo apt install certbot python3-certbot-nginx

# ç”³è¯·è¯ä¹¦
sudo certbot --nginx -d api.ä½ çš„åŸŸå.com

# è‡ªåŠ¨ç»­æœŸæµ‹è¯•
sudo certbot renew --dry-run
```

### 5.9 é…ç½®åç«¯åŸŸå DNS

åœ¨ä½ çš„åŸŸåæœåŠ¡å•†æ·»åŠ  A è®°å½•ï¼š

| ç±»å‹ | åç§° | å€¼ | TTL |
|------|------|-----|-----|
| A | api | ä½ çš„æœåŠ¡å™¨IP | 600 |

---

## ç¬¬å…­æ­¥ï¼šæ›´æ–° Vercel ç¯å¢ƒå˜é‡

éƒ¨ç½²åç«¯åï¼Œéœ€è¦æ›´æ–° Vercel çš„ç¯å¢ƒå˜é‡ï¼š

1. è¿›å…¥ Vercel é¡¹ç›® â†’ **Settings** â†’ **Environment Variables**
2. æ‰¾åˆ° `BACKEND_API_URL`
3. æ›´æ–°ä¸ºï¼š`https://api.ä½ çš„åŸŸå.com`
4. é‡æ–°éƒ¨ç½²ï¼ˆVercel ä¼šè‡ªåŠ¨è§¦å‘ï¼Œæˆ–æ‰‹åŠ¨ç‚¹å‡» **Redeploy**ï¼‰

---

## ğŸ‰ å®Œæˆï¼

æ­å–œï¼ä½ çš„ç½‘ç«™å·²ç»éƒ¨ç½²æˆåŠŸäº†ï¼

### å¸¸ç”¨æ“ä½œ

**æŸ¥çœ‹ Vercel éƒ¨ç½²æ—¥å¿—ï¼š**
- è¿›å…¥é¡¹ç›® â†’ **Deployments** â†’ ç‚¹å‡»æŸä¸ªéƒ¨ç½² â†’ æŸ¥çœ‹æ—¥å¿—

**é‡æ–°éƒ¨ç½²ï¼š**
- åœ¨ Vercel Dashboard ç‚¹å‡» **Redeploy**

**æ›´æ–°ä»£ç ï¼š**
```bash
# ä¿®æ”¹ä»£ç å
git add .
git commit -m "æ›´æ–°è¯´æ˜"
git push
# Vercel ä¼šè‡ªåŠ¨é‡æ–°éƒ¨ç½²
```

**æŸ¥çœ‹åç«¯æ—¥å¿—ï¼š**
```bash
ssh root@ä½ çš„æœåŠ¡å™¨IP
pm2 logs ue-assets-backend
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: éƒ¨ç½²å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**æ£€æŸ¥æ¸…å•ï¼š**
- [ ] ç¯å¢ƒå˜é‡æ˜¯å¦éƒ½é…ç½®äº†ï¼Ÿ
- [ ] `NEXTAUTH_SECRET` æ˜¯å¦è®¾ç½®äº†ï¼Ÿ
- [ ] ä»£ç æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯ï¼Ÿ
- [ ] æŸ¥çœ‹ Vercel éƒ¨ç½²æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

### Q2: åŸŸåæ— æ³•è®¿é—®ï¼Ÿ

**æ£€æŸ¥æ¸…å•ï¼š**
- [ ] DNS è®°å½•æ˜¯å¦æ­£ç¡®é…ç½®ï¼Ÿ
- [ ] ç­‰å¾… DNS ç”Ÿæ•ˆï¼ˆå¯èƒ½éœ€è¦å‡ å°æ—¶ï¼‰
- [ ] åœ¨ Vercel Domains é¡µé¢æ£€æŸ¥çŠ¶æ€

### Q3: åç«¯ API æ— æ³•è¿æ¥ï¼Ÿ

**æ£€æŸ¥æ¸…å•ï¼š**
- [ ] æœåŠ¡å™¨é˜²ç«å¢™æ˜¯å¦å¼€æ”¾äº† 3001 ç«¯å£ï¼Ÿ
- [ ] åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼Ÿ(`pm2 status`)
- [ ] `BACKEND_API_URL` æ˜¯å¦æ­£ç¡®ï¼Ÿ
- [ ] CORS é…ç½®æ˜¯å¦æ­£ç¡®ï¼Ÿ

### Q4: å¦‚ä½•æŸ¥çœ‹é”™è¯¯æ—¥å¿—ï¼Ÿ

**Vercelï¼š**
- é¡¹ç›® â†’ Deployments â†’ ç‚¹å‡»éƒ¨ç½² â†’ æŸ¥çœ‹ Build Logs

**åç«¯ï¼š**
```bash
pm2 logs ue-assets-backend
```

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š
1. æŸ¥çœ‹ Vercel å®˜æ–¹æ–‡æ¡£ï¼šhttps://vercel.com/docs
2. æŸ¥çœ‹é¡¹ç›®ä¸­çš„å…¶ä»–æ–‡æ¡£ï¼ˆå¦‚ `DEPLOYMENT_GUIDE.md`ï¼‰
3. æ£€æŸ¥é”™è¯¯æ—¥å¿—ï¼Œæ ¹æ®é”™è¯¯ä¿¡æ¯æœç´¢è§£å†³æ–¹æ¡ˆ

ç¥éƒ¨ç½²é¡ºåˆ©ï¼ğŸŠ







